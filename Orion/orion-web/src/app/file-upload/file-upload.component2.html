<style>
    .my-drop-zone { border: dotted 3px lightgray; }
    .nv-file-over { border: dotted 3px red; } /* Default class applied to drop zones on over */
    .another-file-over-class { border: dotted 3px green; }

    html, body { height: 100%; }
</style>

<input type="file" id="fileSelector" style="display:none" ng2FileSelect [uploader]="uploader" multiple /><br/>


<div *ngIf="uploader.queue.length > 0">

<div class="alert alert-auto" alert-dismissible
    [ngClass]="{
      'hidden' : alertWin?.alertHidden,
      'alert-danger' :  alertWin.type == 'Error',
      'alert-success' : alertWin.type == 'Info'
    }"
  >
<a  class="close" aria-label="close" (click)="alertWin.alertHidden = true">x</a>
  <strong>{{alertWin.type}}!</strong> {{alertWin.msg}}
</div>



            <table width="100%" class="table tableFont" >
                <thead>
                <tr class="tbl-header">
                    <th >No</th>
                    <th >Inv No</th>
                    <th >BL</th>
                    <th >File</th>
                    <th >Type</th>
                    <th >Description</th>
                    <th >Status</th>
                    <th colspan=3 class="middletext">Actions</th>
                    <th width="1%" class="middletext"> 
                        <button class="btn btn-default" style="border:none"><span (click) = "uploader.clearQueue()" class="glyphicon glyphicon-remove pulllright" aria-hidden="true"></span></button>
                    </th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let item of uploader.queue; let i = index">
                    <td>{{ i+1 }}</td>
                    <td>  
                        <div class="dropdown">
                            <textarea id="inv" #inv class="dropdown-toggle form-control txt-flat" data-toggle="dropdown" rows="2"  
                                placeholder="Inv No" required (keyup)="filterOrder(inv.value)" 
                                [(ngModel)]="itemDetail.invNo" [ngModelOptions]="{standalone: true}"></textarea>
                            
                            <ul class="dropdown-menu item-name">
                            <li >
                                <table class="table table-striped tableFont" style="width:250px">
                                <thead><tr>
                                <th class="text-center">Inv No</th>
                                <th class="text-center">Bill of Loading</th>
                                </tr></thead>
                                <tr *ngFor = "let order of allOrders" 
                                (click)="itemDetail.invNo = order.invNo;itemDetail.bl=order.bl;itemDetail.orderRef=order.id;">
                                <td >{{order.invNo}}</td>
                                <td>{{order.bl}}</td>
                                </tr>
                                </table> 
                            </li>                          
                            </ul>           
                        </div>    
                        </td>
                        <td>
                        <div class="dropdown">
                            <textarea id="bill" #bill class="dropdown-toggle form-control txt-flat" data-toggle="dropdown" rows="2"  
                                placeholder="Inv No" (keyup)="filterOrder(bill.value)" 
                                [(ngModel)]="itemDetail.bl" [ngModelOptions]="{standalone: true}"></textarea>           
                            <ul class="dropdown-menu item-name">
                            <li >
                                <table class="table table-striped tableFont" style="width:250px">
                                <thead><tr>
                                <th class="text-center">Inv No</th>
                                <th class="text-center">Bill of Loading</th>
                                </tr></thead>
                                <tr *ngFor = "let order of allOrders" 
                                (click)="itemDetail.invNo = order.invNo;itemDetail.bl=order.bl;itemDetail.orderRef=order.id;">
                                <td >{{order.invNo}}</td>
                                <td>{{order.bl}}</td>
                                </tr>
                                </table> 
                            </li>
                            </ul>
                        
                        </div>    
                        </td>
                    <td>{{ item?.file?.name }}</td>
                    <td>
                        <div class="btn-group">
                        <button type="button" style ="border:none" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            {{fData[i].type}} <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu">
                            <li *ngFor = "let type of docTypes">
                                <a (click)="changeType(i,type)">{{type}}</a>
                            </li>
                        </ul>
                        </div>
                    </td>
                    <td><input class="txt-flat" type="text" [(ngModel)] = "fData[i].remark" /></td>
                    <td class="text-center">
                        <span *ngIf="item.isSuccess"><i class="glyphicon glyphicon-ok"></i></span>
                        <span *ngIf="item.isCancel"><i class="glyphicon glyphicon-ban-circle"></i></span>
                        <span *ngIf="item.isError"><i class="glyphicon glyphicon-remove"></i></span>
                    </td>
                    <td nowrap>
                        <button type="button" class="btn btn-default btn-xs"
                                (click)="uploadOneFile(item)" [disabled]="item.isReady || item.isUploading || item.isSuccess">
                            <span class="glyphicon glyphicon-upload"></span> Upload
                        </button>
                     </td><td>
                        <button type="button" class="btn btn-default btn-xs"
                                (click)="item.cancel()" [disabled]="!item.isUploading">
                            <span class="glyphicon glyphicon-ban-circle"></span> Cancel
                        </button>
                        </td><td>
                        <button type="button" class="btn btn-default btn-xs"
                                (click)="item.remove()">
                            <span class="glyphicon glyphicon-trash"></span> Remove
                        </button>
                    </td>
                    <td></td>
                </tr>
                <tr>
                    <td colspan=5>
                        <div class="progress" style="">
                            <div class="progress-bar" role="progressbar" [ngStyle]="{ 'width': uploader.progress + '%' }"></div>
                        </div>
                    </td>
                    <td>
                        <button type="button" class="btn btn-default btn-xs"
                        (click)="uploadAllFiles($event)" [disabled]="!uploader.getNotUploadedItems().length">
                            <span class="glyphicon glyphicon-upload"></span> Upload all
                        </button>
                     </td><td>
                        <button type="button" class="btn btn-default btn-xs"
                                (click)="uploader.cancelAll()" [disabled]="!uploader.isUploading">
                            <span class="glyphicon glyphicon-ban-circle"></span> Cancel all
                        </button>
                     </td><td>
                        <button type="button" class="btn btn-default btn-xs"
                                (click)="uploader.clearQueue()" [disabled]="!uploader.queue.length">
                            <span class="glyphicon glyphicon-trash"></span> Remove all
                        </button>
                    </td>
                    <td></td>
                </tr>
                </tbody>
            </table>
<hr style="border-top:1px dotted gray">
</div>



<!--document section-->

<div id="wrapper" style="text-align: center"> 
  <div *ngIf="activeOrder != null" class="dropdown pull-center">
    Documents For : {{activeOrder.item + '(' + activeOrder.brand + ') ordered on '}} {{ activeOrder.createdOn | date: 'dd/MM/yyyy'}}
  </div>
  <div *ngIf="activeOrder==null" class="dropdown pull-center">
    Documents : [{{docType}}]
  </div>
</div>

<form (submit)="addUpdate($event)">
<table class="table table-striped tableFont" [mfData]="data" #mf="mfDataTable" [mfRowsOnPage]="20" >
    <thead>
    <tr>
        <th class="text-center"
            [ngClass]="{
            'text-center' : tableHeader.j=='c' || tableHeader.j=='x',
            'text-left' : tableHeader.j=='l'
            }"
         *ngFor="let tableHeader of headers; let i = index"> 
            <mfDefaultSorter by="{{tableHeader.value}}"><font class ="tbl-header">{{tableHeader.name}}</font></mfDefaultSorter>
        </th>
        <th style="width: 5%;" class ="tbl-header">Action</th>
    </tr>
    </thead>
    <tbody>

      <tr *ngFor="let item of mf.data; let i = index">
         <td class="text-center" >{{i+1 + mf.rowsOnPage*(mf.activePage -1)}}</td>     
         <td class="text-center"
            [ngClass]="{
            'text-center' : tableHeader.j=='c',
            'text-left' : tableHeader.j=='l',
            'hidden' : tableHeader.j=='x'
            }"
         *ngFor="let tableHeader of headers; let i = index">
              <div *ngIf = "tableHeader.value != 'paymentDate'"> 
                {{item[tableHeader.value]}}
              </div>
              <div *ngIf = "tableHeader.value == 'paymentDate'"> 
                {{item[tableHeader.value] | date: 'dd/MM/yyyy'}}
              </div>
            </td>
        <td class="text-center" >
            <div class="dropdown" style="border: 0">
            <button id= "{{item.id.toString() + '-' + item.type}}" #dropButton class="btn btn-default dropdown-toggle"
                (click)="activeProductHeader = dropButton.id"
                 style="border:0px solid transparent !important;background-color:transparent" type="button" id="dropdownMenu2"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                <span class="caret"></span>
            </button>
            <ul id="{{item.id.toString() + '-' + item.supplier}}" #dropDownBox class="dropdown-menu dropdown-menu-right" 
                 aria-labelledby="dropdownMenu2">
                <li *ngIf="item.path.indexOf('pdf')<0"><a id= "{{item.path}" href="{{'documents/image/' + item.path}}" target="_blank">Open</a></li>
                <li *ngIf="item.path.indexOf('pdf')>=0"><a id= "{{item.path}" href="{{'documents/pdf/' + item.path}}" target="_blank">Open</a></li>
                 <li role="separator" class="divider"></li>
                <li><a #deleteitem (click)="triggerDelModal($event)">Delete</a></li>
            </ul>
            </div>
        </td>
      </tr>
    </tbody>
    
    <tfoot>    
    <tr>
        <td colspan="17" > <font class ="tbl-header">
            <mfBootstrapPaginator [rowsOnPageSet]="[5,20,25]"></mfBootstrapPaginator></font>
        </td>
    </tr>
    </tfoot>
</table>

</form>
